\documentclass[12pt, a4paper]{article}
\usepackage[bottom=2cm,top=3cm,left=3cm,right=2cm]{geometry}
\usepackage[brazilian]{babel} % Traduz alguns termos para o português
\usepackage[utf8]{inputenc} % Reconhece acentuação
\usepackage{color,graphicx}
\usepackage{enumerate}
\usepackage{mathtools}
\usepackage{listings}
\usepackage{hyperref}
\hypersetup{
	colorlinks=true,     
	urlcolor=blue
}

\definecolor{olive}{RGB}{175,128,0}
\definecolor{Aquamarine}{RGB}{0,175,175}

\usepackage{setspace}
\onehalfspacing	
\setlength{\parindent}{30pt}

\usepackage{indentfirst}

\title{
	\begin{large}
		Estudo de Caso 1: Inferência Estatística Com Uma Amostra
	\end{large}	}
\author{Gustavo Vieira Costa - 2010022003\\Rafael Castro - 2013030210\\Thaís Matos Acácio - 2013030287}
\date{08/04/2016}

\begin{document}
	\maketitle
	
	\vspace*{-7.5cm}
	{\bf
		\begin{center}
			{\large
				\hspace*{0cm}Universidade Federal de Minas Gerais} \\
			\hspace*{0cm}Engenharia de Sistemas  \\
		\end{center}
	}
	\vspace*{5cm}
	
\section{Introdução}
O BMI (\textit{body mass index}, ou índice de massa corporal) é um indicador frequentemente usado em avaliações clínicas de questões relacionadas ao peso de um indivíduo. Este índice é calculado como a razão entre o peso e o quadrado da estatura.
\par O professor Felipe Campelo, do Departamento de Engenharia Elétrica da UFMG, reporta estar atualmente com um valor de \textit{BMI} = 26.3\textit{kg/$m^{2}$}. Neste estudo de caso vamos buscar responder à pergunta: \textit{Os alunos do curso de Engenharia de Sistemas estão, em média, mais "acima do peso" (de acordo com o BMI) do que este professor?} Para isso, cada um dos alunos da disciplina forneceu seu peso e estatura de forma anonimizada, formando uma base de dados com a qual pretende-se realizar a inferência estatística a respeito da população.	
	
\section{Coleta de dados}
Resultados a partir de uma amostra aleatória obedecem as leis de probabilidade, as quais governam o comportamento aleatório e permitem inferência confiável sobre a população.
\par A Tabela \ref{table:amostra} contém a amostra de dados coletados, informados pelos alunos da turma, juntamente com o valor do índice BMI calculado utilizando a seguinte fórmula:
\begin{equation}
bmi = \frac{m}{h^{2}}
\end{equation}
\newline onde \textit{m} é o peso dado em kg e \textit{h} a altura dada em metros.
	
\begin{table}
\centering
\begin{tabular}{|c|c|c|}
\hline
\rule[-1.0ex]{0pt}{4.0ex}
\textbf{Peso}&\textbf{Altura}&\textbf{BMI}\\ \hline
\rule[-1.0ex]{0pt}{4.0ex}
48.0   &	1.56	&	19.72387 \\ \hline
\rule[-1.0ex]{0pt}{4.0ex}
61.5   &	1.67	&	22.05170 \\ \hline
\rule[-1.0ex]{0pt}{4.0ex}
60.0   & 	1.68	&	21.25850 \\ \hline
\rule[-1.0ex]{0pt}{4.0ex}
63.0   &	1.65	&	23.14050 \\ \hline
\rule[-1.0ex]{0pt}{4.0ex}
57.0   &	1.69	&	19.95728 \\ \hline
\rule[-1.0ex]{0pt}{4.0ex}
80.0   &	1.83	&	23.88844 \\ \hline
\rule[-1.0ex]{0pt}{4.0ex}
76.0   &	1.71	&	25.99090 \\ \hline
\rule[-1.0ex]{0pt}{4.0ex}
70.0   &	1.71	&	23.93899 \\ \hline
\rule[-1.0ex]{0pt}{4.0ex}
70.0   &	1.65	&	25.71166 \\ \hline
\rule[-1.0ex]{0pt}{4.0ex}
66.0   &	1.83	&	19.70796 \\ \hline
\rule[-1.0ex]{0pt}{4.0ex}
52.0   &	1.64	&	19.33373 \\ \hline
\rule[-1.0ex]{0pt}{4.0ex}
68.0   &	1.78	&	21.46194 \\ \hline
\rule[-1.0ex]{0pt}{4.0ex}
82.5   &	1.76	&	26.63352 \\ \hline
\end{tabular}
\caption{Tabela de Amostras}
\label{table:amostra}
\end{table}

\par A partir dos índices BMI calculados podemos obter a média amostral $\bar{x}$ e o desvio-padrão da amostra $s$, os quais quais são estimativas da média $\mu$ e do desvio-padrão $\sigma$ da população completa.
\par De acordo com o \textit{Teorema do Limite Central}, se a amostra tiver tamanho $n$ suficiente, a distribuição amostral de $\bar{x}$ é aproximadamente Normal.
\begin{center}
$\bar{x}$ é aproximadamente $N(\mu,\frac{\sigma}{\sqrt{n}})$
\end{center}
\par Neste experimento, iremos considerar que o tamanho da amostra $n$ é suficiente, pois assim poderemos utilizar os cálculos da probabilidade Normal para responder a questões sobre médias amostrais de muitas observações. Mais observações serão necessárias se a forma da distribuição populacional estiver longe da Normal.

\section{Estratégia de Inferência}
\label{sec:estrategia-inferencia}
O processo de inferência estatística consiste em tirar conclusões sobre uma população com base em informações extraídas de amostras da mesma. No presente estudo de caso, o parâmetro sobre o qual temos interesse é a média $\mu$ do índice BMI da população(alunos de Engenharia de Sistemas).
\newline
\newline
\textbf{Hipóteses de Teste}
\par O teste estatístico é planejado para avaliar a força da evidência \textit{contra} a hipótese nula $H_{0}$. Usualmente, a hipótese nula é uma afirmativa de "nenhum efeito". A afirmativa sobre a população \textit{a favor} da qual estamos tentando achar evidência é a hipótese alternativa $H_{1}$. Logo, as hipóteses são:
\begin{equation}
\left \{
\begin{array}{cc}
H_{0}: & \mu = \mu_{0} \\
H_{1}: & \mu > \mu_{0} \\
\end{array}
\right.
\end{equation}
\newline sendo $\mu$ a média da população, e $\mu_{0}$ o valor de referência, ou seja, BMI do \linebreak professor ($26.3 kg/m^{2}$).
\par Sempre que se seleciona uma amostra existe uma discrepância entre a média dessa amostra e a média da população, esse fato é conhecido como erro padrão da média ou erro amostral. Com base nisso, considerando $\mu_{0}$ como a média populacional, é possível estudar o erro amostral utilizando o teste estatístico t com $n-1$ graus de liberdade.
\par O teste t foi escolhido pois não se sabe previamente qual o desvio padrão da população, o qual consideramos possuir distribuição normal. O termo "graus de liberdade" se refere ao número de observações que são completamente livres para variar.
\newline
\newline
\textbf{Premissas do Teste}
\begin{itemize}
\item O \textbf{nível de significância}, $\alpha$, representa a probabilidade de erro tipo I, ou seja, a probabilidade de rejeitarmos a hipótese nula quando ela é efetivamente verdadeira. Pensando em uma taxa de erro aceitável para o domínio do problema, fixamos $\alpha = 0.05$.
\item $\beta$ representa a \textbf{probabilidade de erro tipo II}, ou seja, aceitarmos a hipótese nula quando ela é efetivamente falsa. Resolvemos permitir um erro tipo II de $20\%$ ($\beta = 0.2$), considerando que esse tipo de erro tem menor impacto negativo do que o erro tipo I.
\item \textbf{Nível de confiança} ($1 - \alpha$) tem como objetivo conhecer o quanto o teste de hipóteses controla um erro do tipo I, ou qual a probabilidade de aceitar a hipótese nula se realmente for verdadeira. 
\item O \textbf{poder do teste} ($1 - \beta$) tem como objetivo conhecer o quanto o teste de hipóteses controla um erro do tipo II ou, qual a probabilidade de rejeitar a hipótese nula se realmente for falsa.
\item Definimos o menor tamanho de efeito de importância prática como 2, tomando como referência o intervalo normal do BMI, o qual varia de 18.5 a 24.99.
\end{itemize}

\par O \textbf{intervalo de confiança} representa a probabilidade do BMI de um aluno escolhido aleatoriamente se encontrar entre os valores limites, inferior e superior, calculados pela distribuição t-student com 12 graus de liberdade.
\par A probabilidade, calculada supondo-se $H_{0}$ verdadeira, de que a estatística de teste assuma um valor tão ou mais extremo do que o valor realmente observado é chamada de \textbf{valor P}.

\section{Projeto experimental}
\label{sec:projeto-experimental}
O código do experimento e o arquivo com os dados da amostra utilizada se encontram disponíveis para download em \url{https://goo.gl/tWi1GV}. Para executá-lo, basta compilar o Script no RStudio e as informações completas sobre sua execução serão exibidas no console da aplicação.
\par Segue o código:

\begin{lstlisting}[language=R]
> mu <- 26.3;
+ alpha <- 0.05;
+	
+ #Ler dados de entrada
+ dados <- read.table("data.csv", header=FALSE, sep=";");
	

+ #Calculo do BMI
+ BMI <- dados[1]/(dados[2]^2);
+	
+ #Numero de Amostras
+ n <- nrow(BMI);
+	
+ #Media
+ x_bar <- mean(as.matrix(BMI));
+	
+ #Tamanho de Efeito
+ size_effect <- x_bar - mu;
+	
+ #Desvio padrao
+ s <- sqrt(sum((BMI-x_bar)^2)/(n-1));
+	
+ #t critico
+ t_alpha <- qt(alpha/2, n-1);
+
+ #T0
+ t0 <- (x_bar - mu)/(s/sqrt(n));
+	
+ #Intervalo de confianca
+ inter_min <- x_bar + (s*t_alpha / (sqrt(n)));
+ inter_max <- x_bar - (s*t_alpha / (sqrt(n)));	
\end{lstlisting}
\par Através do código acima, foi possível obter os resultados necessários para comparação com nossa hipótese inicial.

\section{Análise dos Resultados}
Executando o algoritmo apresentado na seção~\ref{sec:projeto-experimental} (Projeto Experimental), obtemos os seguintes valores para os parâmetros calculados:

\begin{lstlisting}[language=R]
Valor de mu: 26.3
Valor de alpha: 0.05
Numero de amostras: 13
Media amostral: 22.5230002789605
Desvio padrao: 2.56258202347936
Tamanho de efeito: -3.77699972103948
T critico: -2.17881282966723
T0: -5.31423620272294
Intervalo de confianca: 20.9744474604701 a 24.0715530974509
\end{lstlisting}

\par Podemos perceber que os dados são estatisticamente significantes no nível $\alpha$, pois o \textit{valor P} $< \alpha$.
\par Usando a média amostral $\bar{x}$ e o desvio padrão amostral $s$, encontramos a estatística t para hipótese e o valor encontrado se encontra na região de rejeição do intervalo de confiança, ou seja, $t_{0} < t_{\alpha/2}$, portanto rejeitamos a hipótese nula.

\section{Conclusão}
\par Como o intervalo de confiança da média do BMI dos alunos de Engenharia de Sistemas calculado na rotina apresentada, com nível de confiança de 95\% não contém o valor de $\mu_{0}$ BMI do professor Felipe Campelo, podemos concluir que os alunos de Engenharia de Sistemas não estão, em média, mais "acima do peso" (de acordo com o BMI) do que este professor.
\par Para o teste de potência, após rodar o algoritmo do projeto experimental, executamos o seguinte comando, com delta igual a 2, como discutido na seção~\ref{sec:estrategia-inferencia}, nas premissas do teste:

\begin{lstlisting}[language=R]
power.t.test(n=n, delta=2, sd=s, sig.level=alpha, type="one.sample")
\end{lstlisting}

Como saída, obtemos:

\begin{lstlisting}[language=R]
One-sample t test power calculation 
     
n = 13
delta = 2
sd = 2.562582
sig.level = 0.05
power = 0.7336574
alternative = two.sided
\end{lstlisting}

\par Como se pode notar pelo resultado, a potência do teste é 0.7336574. Como forma de melhoria, executamos o seguinte algoritmo para sabermos quantas amostras precisaríamos para ter uma potência igual a 0.9:

\begin{lstlisting}[language=R]
power.t.test(power=0.9, delta=2, sd=s,
	sig.level=alpha, type="one.sample")
\end{lstlisting}

E o resultado foi:

\begin{lstlisting}[language=R]
One-sample t test power calculation 

n = 19.27387
delta = 2
sd = 2.562582
sig.level = 0.05
power = 0.9
alternative = two.sided
\end{lstlisting}

\par Sendo assim, precisaríamos de 20 amostras para termos um teste de cerca de 0.9 de potência.

\begin{thebibliography}{5}
\bibitem{1}{\url{https://github.com/fcampelo/Design-and-Analysis-of-Experiments}}
\bibitem{2}{Estatística Aplicada e Probabilidade para Engenheiros (4ª edição) - Montgomery}
\bibitem{3}{A Estatística Básica e Sua Prática (6ª edição) - David S. Moore, William I. Nortz, Michael A. Fligner}
\bibitem{4}{\url{https://www.youtube.com/watch?v=SacXljL9dKQ&nohtml5=False}}
\bibitem{5}{\url{https://www.youtube.com/watch?v=TJbnkmiZiRU&nohtml5=False}}
\end{thebibliography}		
		
\end{document}